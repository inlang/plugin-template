var x=Object.create;var O=Object.defineProperty;var A=Object.getOwnPropertyDescriptor;var E=Object.getOwnPropertyNames;var K=Object.getPrototypeOf,S=Object.prototype.hasOwnProperty;var T=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var v=(e,t,o,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let c of E(t))!S.call(e,c)&&c!==o&&O(e,c,{get:()=>t[c],enumerable:!(s=A(t,c))||s.enumerable});return e};var F=(e,t,o)=>(o=e!=null?x(K(e)):{},v(t||!e||!e.__esModule?O(o,"default",{value:e,enumerable:!0}):o,e));var w=T((J,P)=>{P.exports=y;y.flatten=y;y.unflatten=C;function R(e){return e&&e.constructor&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}function h(e){return e}function y(e,t){t=t||{};let o=t.delimiter||".",s=t.maxDepth,c=t.transformKey||h,g={};function j(f,b,l){l=l||1,Object.keys(f).forEach(function(r){let n=f[r],i=t.safe&&Array.isArray(n),u=Object.prototype.toString.call(n),a=R(n),m=u==="[object Object]"||u==="[object Array]",p=b?b+o+c(r):c(r);if(!i&&!a&&m&&Object.keys(n).length&&(!t.maxDepth||l<s))return j(n,p,l+1);g[p]=n})}return j(e),g}function C(e,t){t=t||{};let o=t.delimiter||".",s=t.overwrite||!1,c=t.transformKey||h,g={};if(R(e)||Object.prototype.toString.call(e)!=="[object Object]")return e;function f(r){let n=Number(r);return isNaN(n)||r.indexOf(".")!==-1||t.object?r:n}function b(r,n,i){return Object.keys(i).reduce(function(u,a){return u[r+o+a]=i[a],u},n)}function l(r){let n=Object.prototype.toString.call(r),i=n==="[object Array]",u=n==="[object Object]";if(r){if(i)return!r.length;if(u)return!Object.keys(r).length}else return!0}return e=Object.keys(e).reduce(function(r,n){let i=Object.prototype.toString.call(e[n]);return!(i==="[object Object]"||i==="[object Array]")||l(e[n])?(r[n]=e[n],r):b(n,r,y(e[n],t))},{}),Object.keys(e).forEach(function(r){let n=r.split(o).map(c),i=f(n.shift()),u=f(n[0]),a=g;for(;u!==void 0;){if(i==="__proto__")return;let m=Object.prototype.toString.call(a[i]),p=m==="[object Object]"||m==="[object Array]";if(!s&&!p&&typeof a[i]<"u")return;(s&&!p||!s&&a[i]==null)&&(a[i]=typeof u=="number"&&!t.object?[]:{}),a=a[i],n.length>0&&(i=f(n.shift()),u=f(n[0]))}a[i]=C(e[r],t)}),g}});var d=F(w(),1);async function z(e){let t=[];for(let o of e.config.languages){let s=e.pluginConfig.pathPattern.replace("{language}",o),c=(0,d.default)(JSON.parse(await e.$fs.readFile(s,"utf-8")));t.push(M(c,o))}return t}async function $(e){for(let t of e.resources){let o=e.pluginConfig.pathPattern.replace("{language}",t.languageTag.language);await e.$fs.writeFile(o,_(t))}}function M(e,t){return{type:"Resource",id:{type:"Identifier",name:"messages"},languageTag:{type:"LanguageTag",language:t},body:Object.entries(e).map(([o,s])=>N(o,s))}}function N(e,t){return{type:"Message",id:{type:"Identifier",name:e},pattern:{type:"Pattern",elements:[{type:"Text",value:t}]}}}function _(e){let t=Object.fromEntries(e.body.map(B));return JSON.stringify(d.default.unflatten(t),null,2)}function B(e){return[e.id.name,e.pattern.elements[0].value]}export{z as readResources,$ as writeResources};
